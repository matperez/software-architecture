Микросервис - это модуль приложения, который релизится независимо от остальных частей приложения.

К примеру в типичной e-commerce системе можно выделить следующие модули:
- заказы
- регистрация
- поиск товаров

Обычно все эти модули реализуются внутри монолитного приложения. Это означает, что ни один из них не может быть обновлен в продакшене кроме как путем деплоя всего приложения.

Чтобы повысить скорость выкладки в прод и уменьшить число тестов, модули должны быть реализованы независимо друг от друга.

Системы, которые могут быть выложены на прод только целиком называются релизными монолитами. Конечно они могут внутри себя делиться на модули, важно лишь можно ли выложить эти модули отдельно друг от друга.

Приведенное выше определение ничего не говорит о размере микросервисов. Конечно подразумевается, что микросервисы должны быть достаточно невелики, но на практике их размер разнится от очень мелких, до больших размером на многие тысячи строк кода.

#  Преимущества микросервисов

С помощью микросервисов команды могут работать независимо друг от друга не смотря на предметную область и используемые технологии. Это сводит к минимуму необходимость в координации межкомандного взаимодействия в больших проектах.

Работа с устаревшими монолитными системами может быть сложной по следующим причинам:
- Кодовая база плохо структурирована
- Недостаточно тестов, чтобы убедиться в безопасности изменений
- Приходится работать с устаревшими технологиями.
Внедрение микросервисов облегчает этот труд, т.к. новый функционал можно пилить рядом не трогя исходный продукт.

Если микросервис стал сложен в поддержке его можно просто перписать. Это может быть сложным, если от него зависит слишком много других микросервисов, так что важно поддерживать в адекватном состоянии связми между микросервисами.

В монолитном приложении очень легко создать лишние связи между модулями, которые в итоге приводят к плохой архитектуре. В микросервисной архитектуре интерфейс микросервиса естественным образом ограничивает лишния связи между ними, выступает предохранительным барьером для сохранения чистой архитектуры приложения.

Непрерывная доставка - это подход при котором программное обеспечение неприрывно поставляется на прод проходя через пайплайн доставки. Пайплайн проводит по через разные этапы:
- Unit tests
- Acceptance test
- Capasity tests - нагрузочное тестирование
- Explorative tests - исследовательное тестирование. Непонятно как это может быть автоматизировано для того, чтобы запускать это в пайплайне.
- Деплой на прод

Микросервисы представляют из себя независимо выкладываемые модули, так что у каждого микросервиса пайплайн свой.

Микросервисы облегчают процесс непрерывной поставки:
- Они меьнше по размеру, так что их делой проходит быстрее
- Тесты проходят быстрее, т.к. их меньше
- Окружение для тестирования проще поднять так как у микросервиса меньше зависимостей
- Риск релиза микросервиса ниже, чем для монолита

В то же время важно упоминуть, что микросервисы увеличивают количество деплоев, так что переходить на микросервисы стоит только если деплой автоматизирован. 

## Надежность

Микросервисы более надежны т.к. падение одного из них не убъет всю систему, если конечно система построена так, чтобы учитывать падения отдельных сервисов.

Например нужно держать несколько инстансов сервиса в кармане на случай падения одного из них. Нужно кешировать значения получаемые из другого сервиса, чтобы, если он упадает, его клиенты смогли какое-то время поработать и без него.

А вообще конечно могут быть и проблемы:
- Сервисы могут работать на разных серверах, каждый из которых может упасть
- Взаимодействие между сервисами выполняется по сети, которая может вносить свои ошибки и задержки.

## Незвисимое масштабирование

А еще микросервисы могут масштабироваться независимо друг от друга. Например в рождественскую распродажу каталог товаров будет нагружен выше остальных частей приложения. Чтобы была возможность его масштабировать независимо от остальных частей системы нужно что бы он удовлетворял определенным требованиям. Например он должен быть stateless.

## Самостоятельный выбор технологии

Каждый отдельный микросервис может использовать свою технологию реализации. Это так же хороший способ попробовать что-то новое не поломав остальную систему.

## Безопасность

Микросервисы могут быть изолировны друг от друга. Можно даже файрвол поднять между ними или зашифровать общение между микросервисами.

## Разделение микросервисов

Микросервисы могут разделяться по предметной области и по техническим требованиям

К примеру в интернет магазине мы можем выделить следующие сервисы по предметным областям:
- Регистрация 
- Личный кабинет
- Каталог товаров 
- Корзина

В то же время, предположим, что некий этап оплаты товара нагружен выше остальных. В этом случае мы можем выделить его в отдельный микросервис по техническим требованиям.

# Сложности

Деплой микросервисов требует больших усилий, чем деплой монолитов:
- Больше различных систем нужно заливать на прод и мониторить
- Это возможно только если весь процесс деплоя автоматизирован

Деплой и тестирование должны быть независимыми.

Изменения в нескольких микросервисах сразу требуют синхронизации между собой - это тоже сложно. Это требует нескольких взаимозависимых деплоев, которые нужно правильно скоординировать.

В микросервисной архитектуре довольно легко потерять из виду общую картину.

Микросервисы коммуницируют через сеть, таким образом возникают задержки в общении и риск возникновения сбоя передечи информации.


